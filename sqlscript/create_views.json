{
	"name": "create_view_FactSales",
	"properties": {
		"folder": {
			"name": "datawarehouse_DDL_scripts"
		},
		"content": {
			"query": "USE [spulletjes_DW]\nGO\n\nCREATE OR ALTER VIEW vw_FactSales AS\nSELECT\n    ol.OrderLineID AS OrderLineID-- included for source traceability\n    , ol.OrderID AS OrderID  -- included for source traceability\n    , StockItemID\n    -- , ol.Description -- found in DimStockItem as column 'StockItemName'\n    -- , ol.PackageTypeID\n    , Quantity\n    , UnitPrice\n    , TaxRate\n    , PickedQuantity\n    -- , ol.PickingCompletedWhen AS orderLine_PickingCompletedWhen\n    , ol.LastEditedBy AS orderLine_LastEditedBy\n    , ol.LastEditedWhen AS orderLine_LastEditedWhen\n\n    , CustomerID\n    , SalespersonPersonID\n    -- , PickedByPersonID\n    -- , ContactPersonID\n    -- , BackorderOrderID\n    , YEAR(o.OrderDate) * 10000 + MONTH(o.OrderDate) * 100 + DAY(OrderDate) AS OrderDateKey\n    -- , ExpectedDeliveryDate\n    -- , CustomerPurchaseOrderNumber\n    -- , IsUndersupplyBackordered\n    -- , Comments\n    -- , DeliveryInstructions\n    -- , InternalComments\n    -- , o.PickingCompletedWhen AS order_PickingCompletedWhend\n    , o.LastEditedBy AS order_LastEditedBy\n    , o.LastEditedWhen AS order_LastEditedWhen\nFROM\n    OPENROWSET(\n        BULK 'https://dlsspul1234.dfs.core.windows.net/fsspul1234/silver/databases/SalesPurchaseDB/Sales.OrderLines.parquet',\n        FORMAT = 'PARQUET'\n    ) AS [ol] -- OrderLines\nJOIN\n    OPENROWSET(\n        BULK 'https://dlsspul1234.dfs.core.windows.net/fsspul1234/silver/databases/SalesPurchaseDB/Sales.Orders.parquet',\n        FORMAT = 'PARQUET'\n    ) AS [o] -- Orders\nON\n    [ol].[OrderID] = [o].[OrderID]",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "spulletjes_DW",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}